# Dashforge UI-Core — Architectural Decision Record

## ADR-001 — Evaluation Model: Non-Cascading Incremental Engine

### Status

Accepted

### Date

2026-02-18

---

## Context

Dashforge UI-Core is designed to power:

- Intelligent forms
- Predictive UI behavior
- Conditional layout sections
- Controlled UI reactivity based on user interaction

During stress testing, a design question emerged:

Should the engine implement **cascading rule propagation**
(where updates inside rule effects trigger downstream rules automatically),
or remain **non-cascading with explicit incremental evaluation**?

---

## Decision

Dashforge UI-Core will use a:

> **Non-Cascading Incremental Evaluation Model**

Meaning:

- `updateNode()` triggers incremental evaluation.
- `rule.effect()` may call `update()`.
- `update()` inside rule effects **does NOT trigger further rule evaluation automatically**.
- Each evaluation cycle is isolated.
- No automatic propagation chain is performed.

---

## Rationale

### 1️⃣ Real-World Form Patterns

Most enterprise UI logic follows a 1:1 reaction model:

- Country → show Cantons
- Canton → show Cities
- Checkbox → show VAT field
- User inactivity → show related products

These interactions are:

- Direct
- Deterministic
- User-driven
- Shallow in depth

Deep cascading propagation is rarely required in real-world form systems.

---

### 2️⃣ Predictability Over Implicit Reactivity

Cascading engines introduce:

- Implicit propagation
- Hard-to-debug update chains
- Complex visited tracking
- Order sensitivity issues
- Increased cognitive load

Dashforge prioritizes:

- Deterministic behavior
- Clear cause → effect mapping
- Explicit evaluation boundaries
- Debuggability

---

### 3️⃣ Complexity Control

Full cascading engines require:

- Shared evaluation context
- Global visited tracking
- Depth control enforcement
- Diamond dependency handling
- Careful loop detection

This increases:

- Surface area for bugs
- Maintenance cost
- Onboarding complexity
- Mental overhead

For Dashforge’s current mission (predictive UI behavior in forms),
this complexity is unnecessary.

---

### 4️⃣ Domain Alignment

Dashforge UI-Core is:

- A predictive form engine
- A UI behavior orchestration layer

It is NOT:

- A general-purpose reactive graph engine
- A financial rule engine
- A workflow state machine
- A low-code runtime

The evaluation model aligns with domain intent.

---

## Consequences

### Positive

- Deterministic evaluation cycles
- Simpler mental model
- Easier debugging
- Lower risk of infinite loops
- Stable performance characteristics
- Minimal architectural surface

### Negative

- No automatic rule propagation chains
- Complex multi-hop logic requires explicit updates

This trade-off is intentional.

---

## Future Consideration

If Dashforge evolves into:

- A dynamic runtime builder
- A full reactive rule graph system
- A low-code engine

A cascading mode MAY be introduced as:

```
createEngine({ mode: "cascading" })
```

But this is explicitly out of scope for the current architecture.

---

## Architectural Principle Established

Dashforge UI-Core values:

> Predictability over implicit power.

> Determinism over hidden propagation.

> Controlled reactivity over reactive magic.

---

## Final Statement

The engine is designed to be:

- Incremental
- Deterministic
- Explicit
- Stable

Cascading propagation is intentionally not implemented.

This is not a limitation.

It is a design decision.
